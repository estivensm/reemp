<div class="background">
  <nav>
    <div class="row" style="padding-top: 35px">
      <div class="col-md-9 logo" >
          <a href="" ><img src="https://mybc1.s3.amazonaws.com/uploads/rseguimiento/evidencia/374/1.png"></a>
        </div>
      <div class="col-md-3 ingresar-parent">
          <a href="" class="ingresar_login" data-toggle="modal" data-target="#exampleModalCenter">Ingresar</a>
        </div>
    </div>

    <div class="row">


      <div class="col-md-9 offset-md-1 info" >

          <div class="col-md-12">
            <button class="ingresar link_salud margin-right" type="" id="salud">Salud</button>
            <i class="fas fa-check" id="icon-check"></i>
            <button class="ingresar link_mascotas margin-right" type="" id="masko">Mascotas</button>
            <i class="fas fa-check" id="icon-masco"></i>
          </div>

          <div class="col-md-12" style="margin-top: 20px">
            <%#= link_to "Construcción", browser_path(:especialidad => 2), class: "ingresar link_construccion margin-right", id: "cons" %>
            <button class="ingresar link_construccion margin-right" type="" id="cons">Construcción</button>
            <i class="fas fa-check" id="icon-cons"></i>
            <button class="ingresar link_legal margin-right" type="" id="legal">Legal</button>
            <i class="fas fa-check" id="icon-legal"></i>
          </div>

        <%= form_tag browser_path, :method => 'post' do %>

        <div class="form-row">

        <div class="col-md-12" id="autocomplete"></div>


          <div class="col-md-6" style="display: none;" id="imput-salud">
            <%= select_tag 'category_id', options_for_select(get_category.collect{ |u| [u.name, u.id] }),{:class => "form-control chosen-select1", :prompt => 'Especiadad(Cirugia Plastica)'}%>

            <%= button_tag class: "submit1", :title => "Buscar" do %>
              <i class="fas fa-arrow-right icon-row"></i>            
            <% end -%>

          </div>

          <div class="col-md-6" id="imput-masco" style="display: none;">
            <%= select_tag 'specialties', options_for_select(get_special.collect{ |u| [u.name, u.id] }),{:class => "form-control chosen-select1", :prompt => 'Especiadades'}%>
            <%= button_tag class: "submit1", :title => "Buscar" do %>
              <i class="fas fa-arrow-right icon-row"></i>            
            <% end -%>
          </div>

          <div class="col-md-6" style="display: none;" id="imput-const">
            <%= text_field_tag :search2,params[:search1], autocomplete: "off", placeholder: "construccion", class: "form form-control" , id: "" %>

            <%= hidden_field_tag :city,params[:city], autocomplete: "off", id: "city" %>

            <%= button_tag class: "submit1", :title => "Buscar" do %>
              <i class="fas fa-arrow-right icon-row"></i>            
            <% end -%>

          </div>

          <div class="col-md-6" style="display: none;" id="imput-const">
            <%= text_field_tag :search2,params[:search2], autocomplete: "off", placeholder: "construccion", class: "form form-control" %>
            <%= button_tag class: "submit1", :title => "Buscar" do %>
              <i class="fas fa-arrow-right icon-row"></i>            
            <% end -%>
          </div> 

          <div class="col-md-6" style="display: none;" id="imput-legal">
            <%= text_field_tag :search2,params[:search2], autocomplete: "off", placeholder: "legal", class: "form form-control" %>
            <%= button_tag class: "submit1", :title => "Buscar" do %>
              <i class="fas fa-arrow-right icon-row"></i>            
            <% end -%>
          </div> 

          <div class="col-md-5 text-center search-map" style="display: none;">
              <%= text_field_tag :search2,params[:search1], autocomplete: "off", placeholder: "En la Ciudad", class: "form form-control" , id: "autocomplete" %>
          </div>
        </div>

        <% end -%>

      </div>
    </div>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.1.0/themes/algolia.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/css/selectize.css">

  <title>autocomplete-results-page</title>



  <div class="container">
    <h1>InstantSearch.js - Results page with an autocomplete</h1>
    <div id="autocomplete"></div>
    <div id="hits"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/selectize@0.12.6/dist/js/standalone/selectize.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/algoliasearch@3.30.0/dist/algoliasearchLite.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@beta"></script>







<script type="text/javascript">
  /* global $ instantsearch algoliasearch */

const searchClient = algoliasearch(
  'DJ3JJMGZSP',
  'ddbd8bb0730c9044fca8d4ddf2bb5152'
);


const autocomplete = instantsearch.connectors.connectAutocomplete(
  ({ indices, refine, widgetParams }, isFirstRendering) => {
    const { container, onSelectChange } = widgetParams;

    if (isFirstRendering) {
      container.html('<select id="ais-autocomplete"></select>');

      container.find('select').selectize({
        options: [],
        valueField: 'name',
        labelField: 'name',
        highlight: false,
        onType: refine,
        onBlur() {
          refine(this.getValue());
        },
        score() {
          return function() {
            return 1;
          };
        },
        onChange(value) {
          onSelectChange(value);
          refine(value);
        },
      });

      return;
    }

    console.log($("#ais-autocomplete").val());

    const [select] = container.find('select');

    indices.forEach(index => {
      select.selectize.clearOptions();
      index.results.hits.forEach(h => select.selectize.addOption(h));
      select.selectize.refreshOptions(select.selectize.isOpen);
    });
  }
);

const suggestions = instantsearch({
  indexName: 'Contact_development',
  searchClient,
});

suggestions.addWidget(
  instantsearch.widgets.configure({
    hitsPerPage: 5,
  })
);

suggestions.addWidget(
  autocomplete({
    container: $('#autocomplete'),
    onSelectChange(value) {
      console.log(this);
      search.helper.setQuery(value).search();
    },
  })
);

const search = instantsearch({
  indexName: 'Contact_development',
  searchClient,
});

search.addWidget(
  instantsearch.widgets.configure({
    hitsPerPage: 10,
  })
);


suggestions.start();
search.start();

</script>

<style type="text/css" media="screen">
  h1 {
  margin-bottom: 1rem;
}

em {
  background: cyan;
  font-style: normal;
}

.container {
  max-width: 960px;
  margin: 0 auto;
  padding: 1em;
}

.ais-hits {
  margin-top: 1em;
}

.hit-name {
  margin-bottom: 0.5em;
}

.hit-description {
  color: #888;
  font-size: 14px;
  margin-bottom: 0.5em;
}


.hit-id {
  color: #888;
  font-size: 14px;
  margin-bottom: 0.5em;
}

</style>

<%= render "parciales/sesion" %>

<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places&language=en&key=AIzaSyBCTHCpTg9kTvg7uBcO0wYvpA7_Tw8Lkxg"></script>
<script src="//cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {

      var input = document.getElementById('autocomplete');
      var autocomplete = new google.maps.places.Autocomplete(input,{types: ['(cities)']});
      google.maps.event.addListener(autocomplete, 'place_changed', function(){
         var place = autocomplete.getPlace();
         console.log(place);
         console.log(place.name);
         //document.getElementById("place_id").value = place.place_id;
         document.getElementById("city").value = place.name;
      })

    

    var salud = document.getElementById("salud");
    var masco = document.getElementById("masko");
    var cons = document.getElementById("cons");
    var legal = document.getElementById("legal");

    var imputsa = document.getElementById("imput-salud");
    var imputmas = document.getElementById("imput-masco");
    var imputconst = document.getElementById("imput-const");
    var imputlegal = document.getElementById("imput-legal");

    var icon_salud = document.getElementById("icon-check");
    var icon_masco = document.getElementById("icon-masco");
    var icon_cons = document.getElementById("icon-cons");
    var icon_legal = document.getElementById("icon-legal");

    $(salud).click(function(event) {
      $(this).addClass('opacidad');
      $(".search-map").show("linear");
      $(icon_salud).addClass('show');
      $(icon_masco).removeClass('show').addClass('hide')
      $(icon_cons).removeClass('show').addClass('hide')
      $(icon_legal).removeClass('show').addClass('hide')

      $(masco).removeClass('opacidad');
      $(cons).removeClass('opacidad');
      $(legal).removeClass('opacidad');

      $(imputsa).show("linear");
      $(imputmas).hide("linear");
      $(imputconst).hide("linear");
      $(imputlegal).hide("linear");
    });

    $(masco).click(function(event) {
      $(this).addClass('opacidad');
      
      $(icon_masco).addClass('show');
      $(icon_salud).removeClass('show').addClass('hide');
      $(icon_cons).removeClass('show').addClass('hide')
      $(icon_legal).removeClass('show').addClass('hide')

      $(".search-map").show("linear");
      $(salud).removeClass('opacidad');
      $(cons).removeClass('opacidad');
      $(legal).removeClass('opacidad');

      $(imputmas).show("linear"); 
      $(imputsa).hide("linear"); 
      $(imputconst).hide("linear"); 
      $(imputlegal).hide("linear");       
    });

    $(cons).click(function(event) {
      $(this).addClass('opacidad');

      $(icon_cons).addClass('show');
      $(icon_masco).removeClass('show').addClass('hide');
      $(icon_salud).removeClass('show').addClass('hide');
      $(icon_legal).removeClass('show').addClass('hide');

      $(salud).removeClass('opacidad');
      $(masco).removeClass('opacidad');
      $(legal).removeClass('opacidad');
      $(".search-map").show("linear");
      $(imputconst).show("linear");  
      $(imputmas).hide("linear"); 
      $(imputsa).hide("linear"); 
      $(imputlegal).hide("linear"); 
    });

    $(legal).click(function(event) {
      $(this).addClass('opacidad');

      $(icon_legal).addClass('show');
      $(icon_cons).removeClass('show').addClass('hide');
      $(icon_masco).removeClass('show').addClass('hide');
      $(icon_salud).removeClass('show').addClass('hide');
      $(".search-map").show("linear");
      $(salud).removeClass('opacidad');
      $(masco).removeClass('opacidad');
      $(cons).removeClass('opacidad');

      $(imputlegal).show("linear");  
      $(imputconst).hide("linear");  
      $(imputmas).hide("linear"); 
      $(imputsa).hide("linear");    
    });

  });

</script>

<style type="text/css" media="screen">


  .search-map{
    float: right;
    margin-top: 27px;
  }

  #icon-check{
    position: absolute;
    left: 60px;
    top: 9px;
    display: none;
  }

  #icon-masco{
    position: absolute;
    left: 213px;
    top: 9px;
    display: none;
  }

  #icon-cons{
    position: absolute;
    left: 106px;
    top: 9px;
    display: none;
  }

  #icon-legal{
    position: absolute;
    left: 280px;
    top: 9px;
    display: none;
  }

  .show{
    display: block;
  }

  .hide{
    display: none;
  }

  #imput-masco{margin-top: 26px;}
  #imput-const{margin-top: 26px;}
  #imput-salud{margin-top: 26px;}
  #imput-legal{margin-top: 26px;}

  .h3{
    margin-left: 3px;
    margin-top: 0px;
  }

  #imput-masco .form{
    border-radius: 25px;
    box-shadow: -2px -4px 10px #dcdcfe, 2px 7px 10px #dcdcfe;
  }

  #imput-const .form{
    border-radius: 25px;
    box-shadow: -2px -4px 10px #dcdcfe, 2px 7px 10px #dcdcfe;
  }

  #imput-salud .form{
    border-radius: 25px;
    box-shadow: -2px -4px 10px #dcdcfe, 2px 7px 10px #dcdcfe;
  }

  #imput-legal .form{
    border-radius: 25px;
    box-shadow: -2px -4px 10px #dcdcfe, 2px 7px 10px #dcdcfe;
  }

  .opacidad{
    opacity: 0.5;
    filter: alpha(opacity=50); /* For IE8 and earlier */
  }

  .icon-row{
    color: #fff;
  }

  .submit1{
    border-radius: 15px;
    border: none;
    background-color: #9B25DE;
    z-index: 1;
    position: relative;
    float: right;
    top: -32px;
    width: 72px;
    padding: 3px;
  }

  .hit-auto-complete{
    background-color: #fff;
    padding: 10px;
    border-radius: 4px;
    width: 100%;
  }

  .chosen-container-single .chosen-single{
    border: 1px solid #f2f2f2;
    font-family: "Poppins", sans-serif;
    font-size: 0.75rem;
    padding: 0.56rem 0.75rem;
    line-height: 14px;
    font-weight: 300;
    background-color: #fff;
    border-radius: 5px;
    box-shadow: -2px -4px 10px #dcdcfe, 2px 7px 10px #dcdcfe;
  }

  .chosen-single{
    background: white !important;
  }

  em{
    background-color: red;
  }

  .display{
    display: none;
  }

  .card-input{
    position: relative;
    top: -250px;
  }


  .modal-open{
    padding: 0px !important;

  }


  
</style>